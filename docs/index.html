<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Solana Tools – SPL Toolkit by Kevin Smits</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Old-school Nintendo style fonts -->
  <link
    href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Space+Mono:wght@400;700&display=swap"
    rel="stylesheet"
  />

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      min-height: 100vh;
      background: radial-gradient(circle at top, #1f2937 0, #020617 55%, #000 100%);
      color: #e5e7eb;
      font-family: "Space Mono", monospace;
      display: flex;
      justify-content: center;
      padding: 24px;
    }

    .app {
      width: 1200px;
      max-width: 100%;
      border: 4px solid #22d3ee;
      box-shadow: 0 0 0 4px #0f172a, 0 0 40px rgba(34, 211, 238, 0.4);
      background: #020617;
      padding: 20px 24px 28px;
      position: relative;
      overflow: hidden;
    }

    .app::before {
      content: "";
      position: absolute;
      inset: 0;
      background-image: linear-gradient(
        rgba(255, 255, 255, 0.03) 1px,
        transparent 1px
      );
      background-size: 100% 3px;
      pointer-events: none;
      mix-blend-mode: soft-light;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 18px;
      position: relative;
      z-index: 1;
    }

    .title-block {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    h1 {
      font-family: "Press Start 2P", system-ui;
      font-size: 18px;
      letter-spacing: 3px;
      text-transform: uppercase;
      color: #facc15;
      text-shadow: 2px 2px 0 #000, 0 0 8px #facc15;
    }

    .subtitle {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 2px;
      color: #9ca3af;
    }

    .badge-ks {
      font-size: 9px;
      text-transform: uppercase;
      letter-spacing: 2px;
      padding: 6px 10px;
      border: 2px solid #22d3ee;
      background: #020617;
      color: #e5e7eb;
      box-shadow: 2px 2px 0 #000;
    }

    main {
      display: grid;
      grid-template-columns: minmax(0, 2.1fr) minmax(0, 1.4fr);
      gap: 18px;
      position: relative;
      z-index: 1;
    }

    .panel {
      border: 3px solid #22d3ee;
      background: rgba(15, 23, 42, 0.96);
      padding: 14px 14px 16px;
      box-shadow: 3px 3px 0 #000;
      position: relative;
      overflow: hidden;
    }

    .panel + .panel {
      margin-top: 10px;
    }

    .panel-title {
      font-family: "Press Start 2P", system-ui;
      font-size: 11px;
      letter-spacing: 2px;
      text-transform: uppercase;
      color: #a5b4fc;
      margin-bottom: 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .panel-title span.label {
      font-size: 8px;
      padding: 2px 6px;
      border: 1px solid #4ade80;
      color: #bbf7d0;
    }

    .grid-2 {
      display: grid;
      grid-template-columns: minmax(0, 1.35fr) minmax(0, 1.65fr);
      gap: 10px;
      margin-bottom: 10px;
    }

    .field-label {
      font-size: 9px;
      letter-spacing: 1px;
      text-transform: uppercase;
      margin-bottom: 4px;
      color: #9ca3af;
    }

    input[type="text"] {
      width: 100%;
      padding: 8px 9px;
      border: 2px solid #22d3ee;
      background: #020617;
      color: #e5e7eb;
      font-family: "Space Mono", monospace;
      font-size: 11px;
      outline: none;
      box-shadow: inset 0 0 0 1px #0f172a;
    }

    input[type="text"]::placeholder {
      color: #6b7280;
    }

    .button-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin: 10px 0 8px;
    }

    button.pixel-btn {
      font-family: "Press Start 2P", system-ui;
      font-size: 9px;
      text-transform: uppercase;
      letter-spacing: 1px;
      border: 2px solid #22d3ee;
      background: #020617;
      color: #e5e7eb;
      padding: 6px 8px;
      cursor: pointer;
      box-shadow: 2px 2px 0 #000;
      transition: transform 0.05s ease, box-shadow 0.05s ease,
        background 0.1s ease, color 0.1s ease;
      white-space: nowrap;
    }

    button.pixel-btn:hover {
      transform: translate(-1px, -1px);
      box-shadow: 3px 3px 0 #000;
      background: #0f172a;
    }

    button.pixel-btn:active {
      transform: translate(1px, 1px);
      box-shadow: 1px 1px 0 #000;
      background: #22d3ee;
      color: #020617;
    }

    button.pixel-btn.secondary {
      border-color: #f97316;
      color: #fed7aa;
    }

    button.pixel-btn.secondary:hover {
      background: #7c2d12;
    }

    .status-bar {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 10px;
      margin-bottom: 6px;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border: 2px solid #111827;
      background: #22c55e;
      box-shadow: 0 0 6px #22c55e;
    }

    .status-text {
      color: #a5b4fc;
    }

    .output-box {
      background: #020617;
      border: 2px solid #4b5563;
      padding: 8px;
      min-height: 190px;
      max-height: 260px;
      overflow: auto;
      font-family: "Space Mono", monospace;
      font-size: 11px;
      color: #e5e7eb;
      line-height: 1.4;
      white-space: pre;
    }

    .tiny {
      font-size: 9px;
      color: #6b7280;
      margin-top: 4px;
    }

    .list {
      list-style: none;
      font-size: 10px;
      line-height: 1.6;
      color: #e5e7eb;
    }

    .list li {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .list li::before {
      content: "▸";
      color: #22d3ee;
      font-size: 9px;
    }

    .mono-line {
      font-size: 9px;
      color: #9ca3af;
      margin-bottom: 4px;
      white-space: nowrap;
    }

    .mono-line code {
      color: #e5e7eb;
    }

    .backend-input-row {
      display: flex;
      gap: 6px;
      margin-top: 6px;
    }

    .backend-input-row input {
      flex: 1;
      font-size: 10px;
    }

    @media (max-width: 960px) {
      main {
        grid-template-columns: minmax(0, 1fr);
      }
    }
  </style>
</head>

<body>
  <div class="app">
    <header>
      <div class="title-block">
        <h1>SOLANA TOOLS</h1>
        <div class="subtitle">SPL on-chain insights · Web2 style · read-only</div>
      </div>
      <div class="badge-ks">BY KEVIN SMITS</div>
    </header>

    <main>
      <!-- LEFT: Inputs + output -->
      <section class="panel">
        <div class="panel-title">
          <span>Wallet &amp; Token Console</span>
          <span class="label">INPUTS</span>
        </div>

        <div class="grid-2">
          <div>
            <div class="field-label">Wallet address</div>
            <input
              id="wallet-input"
              type="text"
              placeholder="Enter Solana wallet (public key)"
            />
          </div>
          <div>
            <div class="field-label">Token mint</div>
            <input
              id="mint-input"
              type="text"
              placeholder="Enter SPL token mint (default: CBS)"
              value="B9z8cEWFmc7LvQtjKsaLoKqW5MJmGRCWqs1DPKupCfkk"
            />
          </div>
        </div>

        <div class="button-row">
          <button id="btn-wallet-info" class="pixel-btn">Wallet info</button>
          <button id="btn-token-info" class="pixel-btn">Token info</button>
          <button id="btn-holder-info" class="pixel-btn">Holder info</button>
          <button id="btn-cbs-metrics" class="pixel-btn">DEX metrics</button>
          <button id="btn-whale-tracker" class="pixel-btn">Whale tracker</button>
          <button id="btn-token-safety" class="pixel-btn secondary">
            Token safety
          </button>
          <button id="btn-clear" class="pixel-btn" style="margin-left:auto;">
            Clear
          </button>
        </div>

        <div class="status-bar">
          <div id="status-dot" class="status-dot"></div>
          <div id="status" class="status-text">Ready</div>
        </div>

        <div id="output" class="output-box"></div>
        <div class="tiny">
          Read-only tools: this UI never asks for private keys and does no transactions.
        </div>
      </section>

      <!-- RIGHT SIDE -->
      <div style="display:flex; flex-direction:column; gap:10px;">
        <section class="panel">
          <div class="panel-title">
            <span>Available tools</span>
            <span class="label">solana-tools</span>
          </div>
          <ul class="list">
            <li><code>wallet-info</code> – SOL balance &amp; SPL token balances</li>
            <li><code>token-info</code> – token decimals, supply, authorities</li>
            <li><code>cbs-metrics</code> – DexScreener prices &amp; liquidity</li>
            <li><code>holder-info</code> – SPL holder snapshot (coming soon)</li>
            <li><code>whale-tracker</code> – large holder / movement alerts (coming)</li>
            <li><code>token-safety-check</code> – risk heuristics (immutable, LP, freeze)</li>
          </ul>
        </section>

        <section class="panel">
          <div class="panel-title">
            <span>Expected backend endpoints</span>
            <span class="label">API contract</span>
          </div>
          <div class="mono-line">
            GET <code>/api/wallet-info?address=...</code>
          </div>
          <div class="mono-line">
            GET <code>/api/token-info?mint=...</code>
          </div>
          <div class="mono-line">
            GET <code>/api/cbs-metrics?mint=...</code>
          </div>
          <div class="mono-line">
            GET <code>/api/holder-info?mint=...</code>
          </div>
          <div class="mono-line">
            GET <code>/api/whale-tracker?mint=...&amp;address=...</code>
          </div>
          <div class="mono-line">
            GET <code>/api/token-safety-check?mint=...</code>
          </div>
        </section>

        <section class="panel">
          <div class="panel-title">
            <span>Backend base URL</span>
            <span class="label">Config</span>
          </div>
          <div id="backend-label" class="mono-line"></div>
          <div class="backend-input-row">
            <input
              id="backend-input"
              type="text"
              placeholder="https://your-backend-domain.com"
            />
          </div>
          <div class="tiny">
            Default points to the public <code>solana-tools-api</code> instance on Render.
            You can host your own and override the URL here.
          </div>
        </section>
      </div>
    </main>
  </div>

  <script>
    const walletInput = document.getElementById("wallet-input");
    const mintInput = document.getElementById("mint-input");
    const outputEl = document.getElementById("output");
    const statusEl = document.getElementById("status");
    const statusDot = document.getElementById("status-dot");
    const backendLabel = document.getElementById("backend-label");
    const backendInput = document.getElementById("backend-input");

    // Default backend = jouw Render API
    let API_BASE = "https://solana-tools-api.onrender.com";

    backendInput.value = API_BASE;
    backendLabel.textContent = "Backend base URL: " + API_BASE;

    function setStatus(ok, text) {
      statusEl.textContent = text;
      statusDot.style.background = ok ? "#22c55e" : "#f97373";
      statusDot.style.boxShadow = ok ? "0 0 6px #22c55e" : "0 0 6px #f97373";
    }

    function renderWalletInfo(data) {
      const lines = [];
      lines.push("=== WALLET INFO ===");
      lines.push("Address : " + (data.address || "?"));

      if (typeof data.sol === "number") {
        lines.push("SOL     : " + data.sol.toFixed(6) + " SOL");
      }

      const tokens = Array.isArray(data.tokens) ? data.tokens : [];
      if (tokens.length) {
        lines.push("");
        lines.push("SPL tokens (non-zero balances):");
        tokens.forEach((t, i) => {
          const amt =
            typeof t.uiAmount === "number"
              ? t.uiAmount.toString()
              : String(t.amountRaw || "?");
          lines.push(
            " " +
              (i + 1) +
              ". " +
              amt +
              "  (mint: " +
              t.mint +
              ", decimals: " +
              t.decimals +
              ")"
          );
        });
      } else {
        lines.push("");
        lines.push("SPL tokens : none with non-zero balance returned.");
      }

      outputEl.textContent = lines.join("\n");
    }

    function renderTokenInfo(data) {
      const lines = [];
      lines.push("=== TOKEN INFO ===");
      lines.push("Mint      : " + (data.mint || "?"));
      lines.push("Decimals  : " + (data.decimals ?? "?"));
      lines.push("Supply    : " + (data.supply ?? "?"));
      lines.push(
        "Mint auth : " +
          (data.mintAuthority === null
            ? "revoked (immutable)"
            : data.mintAuthority || "unknown")
      );
      lines.push(
        "Freeze    : " +
          (data.freezeAuthority === null
            ? "revoked"
            : data.freezeAuthority || "unknown")
      );
      outputEl.textContent = lines.join("\n");
    }

    function renderDexMetrics(data) {
      const lines = [];
      lines.push("=== DEX METRICS ===");
      lines.push("Mint          : " + (data.mint || "?"));
      lines.push("Total pools   : " + (data.totalPools ?? 0));
      lines.push("Raydium pools : " + (data.raydiumCount ?? 0));
      lines.push(
        "Other DEXes   : " + (data.otherDexCount ?? 0)
      );
      if (typeof data.totalLiquidityUsd === "number") {
        lines.push(
          "Total Raydium liquidity: $" +
            data.totalLiquidityUsd.toFixed(2)
        );
      }

      const ray = Array.isArray(data.raydium) ? data.raydium : [];
      if (ray.length) {
        lines.push("");
        lines.push("Raydium pairs:");
        ray.forEach((p, i) => {
          lines.push(
            " " +
              (i + 1) +
              ". " +
              (p.baseToken?.symbol || "?") +
              "/" +
              (p.quoteToken?.symbol || "?") +
              " – $" +
              (p.priceUsd || "?") +
              " (liq: $" +
              (p.liquidityUsd ?? "?") +
              ")"
          );
        });
      }

      outputEl.textContent = lines.join("\n");
    }

    function renderTokenSafety(data) {
      const lines = [];
      lines.push("=== TOKEN SAFETY CHECK ===");
      lines.push("Mint      : " + (data.mint || "?"));
      const s = data.safety || {};
      lines.push("Risk      : " + (s.riskLevel || "unknown"));
      lines.push(
        "Immutable : " + (s.immutableMint ? "yes" : "no")
      );
      lines.push(
        "Can freeze: " + (s.canFreeze ? "yes" : "no")
      );
      if (typeof s.lowLiquidity === "boolean") {
        lines.push("Low liquidity : " + (s.lowLiquidity ? "yes" : "no"));
      }
      if (typeof (data.dex?.totalLiquidityUsd) === "number") {
        lines.push(
          "Total liquidity: $" +
            data.dex.totalLiquidityUsd.toFixed(2)
        );
      }

      const reasons = Array.isArray(s.reasons) ? s.reasons : [];
      if (reasons.length) {
        lines.push("");
        lines.push("Reasons:");
        reasons.forEach((r, i) => {
          lines.push(" " + (i + 1) + ". " + r);
        });
      }

      if (data.disclaimer) {
        lines.push("");
        lines.push("Note: " + data.disclaimer);
      }

      outputEl.textContent = lines.join("\n");
    }

    function renderPlainText(text) {
      outputEl.textContent = text;
    }

    async function callApi(kind, path) {
      try {
        const base = API_BASE.replace(/\/+$/, "");
        const url = base + path;

        setStatus(true, "Calling " + kind + " ...");
        const res = await fetch(url);
        const data = await res.json();

        if (!res.ok) {
          setStatus(false, "Error " + res.status + " – see raw JSON in console");
          console.error("API error", kind, data);
          renderPlainText("Error " + res.status + ": " + (data.error || "see console"));
          return;
        }

        setStatus(true, "OK - " + kind + " responded");

        if (kind === "wallet-info") return renderWalletInfo(data);
        if (kind === "token-info") return renderTokenInfo(data);
        if (kind === "cbs-metrics") return renderDexMetrics(data);
        if (kind === "token-safety") return renderTokenSafety(data);

        // fallback
        renderPlainText(JSON.stringify(data, null, 2));
      } catch (e) {
        console.error(e);
        setStatus(false, "Network error calling " + kind);
        renderPlainText("Network error: " + String(e));
      }
    }

    // Buttons
    document
      .getElementById("btn-wallet-info")
      .addEventListener("click", () => {
        const addr = walletInput.value.trim();
        if (!addr) {
          setStatus(false, "Fill wallet address first");
          return;
        }
        callApi("wallet-info", "/api/wallet-info?address=" + encodeURIComponent(addr));
      });

    document
      .getElementById("btn-token-info")
      .addEventListener("click", () => {
        const mint =
          mintInput.value.trim() ||
          "B9z8cEWFmc7LvQtjKsaLoKqW5MJmGRCWqs1DPKupCfkk";
        callApi("token-info", "/api/token-info?mint=" + encodeURIComponent(mint));
      });

    document
      .getElementById("btn-cbs-metrics")
      .addEventListener("click", () => {
        const mint =
          mintInput.value.trim() ||
          "B9z8cEWFmc7LvQtjKsaLoKqW5MJmGRCWqs1DPKupCfkk";
        callApi("cbs-metrics", "/api/cbs-metrics?mint=" + encodeURIComponent(mint));
      });

    document
      .getElementById("btn-token-safety")
      .addEventListener("click", () => {
        const mint =
          mintInput.value.trim() ||
          "B9z8cEWFmc7LvQtjKsaLoKqW5MJmGRCWqs1DPKupCfkk";
        callApi(
          "token-safety",
          "/api/token-safety-check?mint=" + encodeURIComponent(mint)
        );
      });

    // Nog niet geïmplementeerde endpoints in backend
    document
      .getElementById("btn-holder-info")
      .addEventListener("click", () => {
        setStatus(false, "Holder info API not wired yet");
        renderPlainText(
          "Endpoint /api/holder-info is nog niet geïmplementeerd op deze backend."
        );
      });

    document
      .getElementById("btn-whale-tracker")
      .addEventListener("click", () => {
        setStatus(false, "Whale tracker API not wired yet");
        renderPlainText(
          "Endpoint /api/whale-tracker is nog niet geïmplementeerd op deze backend."
        );
      });

    document.getElementById("btn-clear").addEventListener("click", () => {
      outputEl.textContent = "";
      setStatus(true, "Cleared");
    });

    backendInput.addEventListener("change", () => {
      const v = backendInput.value.trim();
      if (!v) return;
      API_BASE = v.replace(/\/+$/, "");
      backendLabel.textContent = "Backend base URL: " + API_BASE;
      setStatus(true, "Backend URL updated");
    });

    setStatus(true, "Ready");
  </script>
</body>
</html>

